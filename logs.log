2025-12-29 17:57:24,587 Error in setting up client for bq ingestion
Traceback (most recent call last):
  File "C:\Users\pnage\AppData\Local\Programs\Python\Python312\Lib\site-packages\google\cloud\bigquery\client.py", line 2680, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pnage\AppData\Local\Programs\Python\Python312\Lib\site-packages\google\cloud\bigquery\client.py", line 3244, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "C:\Users\pnage\AppData\Local\Programs\Python\Python312\Lib\site-packages\google\resumable_media\requests\upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pnage\AppData\Local\Programs\Python\Python312\Lib\site-packages\google\resumable_media\requests\_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "C:\Users\pnage\AppData\Local\Programs\Python\Python312\Lib\site-packages\google\resumable_media\requests\upload.py", line 149, in retriable_request
    self._process_response(result)
  File "C:\Users\pnage\AppData\Local\Programs\Python\Python312\Lib\site-packages\google\resumable_media\_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "C:\Users\pnage\AppData\Local\Programs\Python\Python312\Lib\site-packages\google\resumable_media\_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\pnage\programs\web3-analysis\main.py", line 37, in main
    ib.bq_load(df, client, jobConf, destination)
  File "c:\Users\pnage\programs\web3-analysis\ingest_bq.py", line 21, in bq_load
    job = client.load_table_from_dataframe(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pnage\AppData\Local\Programs\Python\Python312\Lib\site-packages\google\cloud\bigquery\client.py", line 2920, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pnage\AppData\Local\Programs\Python\Python312\Lib\site-packages\google\cloud\bigquery\client.py", line 2684, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/logical-hallway-324305/jobs?uploadType=multipart: Invalid value for jobConfigurationLoad.writeDisposition: WRITE_APEND is not a valid value
